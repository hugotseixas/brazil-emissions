---
title: "Greenhouse Gas Emission and Removal in Brazil"
author: "Hugo Tameirão Seixas"
institute: UNICAMP
format: 
  revealjs:
    theme: [default, custom.scss]
    reference-location: document
---

```{r}
#| label: load-material
#| include: false

library(highcharter)
library(shades)
library(fs)
library(here)
library(curl)
library(readxl)
library(tidyverse)

source("R/fig_theme.R")
source("R/data_obj.R")
source("R/plot_obj.R")

```


## How much Brazil emits? Does it matter?

<br>

::: incremental


-   Brazil emitted <B>`r round(br_emission_2020, 1)` billion tonnes</B> of CO<sub>2</sub>-eq in 2020 [^1]

-   The world emitted <B>50.1 billion tonnes</B> of CO<sub>2</sub>-eq in 2020 [^2]

-   So Brazil emitted only <B>`r round(br_emission_2020/50.1 * 100, 1)`%</B> of all the emission in 2020?

- But countries that emitted lass than Brazil accounts for almost <B>40%</B> of all the emissions!

- <B>Every country have to decrease emissions!</B>

:::

[^1]: Climate Observatory: [Greenhouse Gas Emissions and Removal Estimation System](https://seeg.eco.br/en?cama_set_language=en)
[^2]: Rhodium Group: [Preliminary 2020 Global Greenhouse Gas Emissions Estimates](https://rhg.com/research/preliminary-2020-global-greenhouse-gas-emissions-estimates/)

## Total Emissions {.smaller}

::: panel-tabset

### Map

```{r}
#| label: total-emissions-map
#| echo: false
#| output-location: slide

plot_data <- maps_table(total = TRUE)

hc_map <- maps_plot(min_color = "#b7b7b7", max_color = "#434343")

hc_map

```

### Total Emissions

```{r}
#| label: total-emissions
#| echo: false
#| output-location: slide

plot_data <- emissions_table(total = TRUE, type_list = "Emissão")

hc_plot <- 
  emissions_plot(
    total = TRUE, 
    group_id = "type",
    color_list = c("#5f5f5f")
  )

hc_plot

```

### Emissions by Sector

```{r}
#| label: sector-emissions
#| echo: false
#| output-location: slide

plot_data <- emissions_table(type_list = "Emissão")

hc_plot <- 
  emissions_plot(
    group_id = "scope",
    color_list = c("#432905", "#313E59", "#467852", "#8B204B", "#C22805")
  )

hc_plot

```

### Fraction by Sector

```{r}
#| label: fraction-emissions
#| echo: false
#| output-location: slide

plot_data <- seeg |>
  dplyr::filter(
    type %in% c("Emissão"),
    year >= 1990
  ) |>
  dplyr::group_by(scope, year) |>
  dplyr::summarise(emission = sum(emission, na.rm = TRUE), .groups = "keep") |>
  group_by(year) |>
  mutate(emission = emission / sum(emission) * 100)

hc_plot <- 
  hchart(
    object = plot_data, 
    type = "column", 
    hcaes(x = year, y = emission, group = scope)
  ) |>
  hc_yAxis(
    max = 100,
    title = list(text = "Percentage CO<sub>2</sub>-eq emissions (%)")
  ) |>
  hc_tooltip(valueDecimals = 0, valueSuffix = "%") |>
  hc_add_theme(a11y_theme) |>
  hc_colors(colors = c("#432905", "#313E59", "#467852", "#8B204B", "#C22805"))

hc_plot

```

### Description

:::

## Residues {.smaller}

::: panel-tabset

### Map

```{r}
#| label: residue-emissions-map
#| echo: false
#| output-location: slide

plot_data <- maps_table(seeg_scope = "Resíduos")

hc_map <- maps_plot(min_color = "#FC9D88", max_color = "#EF3106")

hc_map

```

### Emissions

```{r}
#| label: residue-emissions
#| echo: false
#| output-location: slide

plot_data <- 
  emissions_table(
  seeg_scope = "Resíduos", 
  seeg_activity = TRUE,
  type_list = "Emissão"
)

hc_plot <- 
  emissions_plot(
    group_id = "activity",
    color_list = gradient(c("#FC9D88","#EF3106", "#501002"), 5)
  )

hc_plot

```

### Fraction

```{r}
#| label: residue-fraction
#| echo: false
#| output-location: slide

plot_data <- seeg |>
  dplyr::filter(
    type %in% c("Emissão"),
    as.numeric(year) >= 1990,
    scope == "Resíduos"
  ) |>
  dplyr::group_by(activity, year) |>
  dplyr::summarise(emission = sum(emission, na.rm = TRUE), .groups = "drop") |>
  dplyr::mutate(emission = emission * 1e-6, digits = 0) |>
  group_by(year) |>
  mutate(emission = emission / sum(emission) * 100)

hc_plot <- 
  hchart(
    object = plot_data, 
    type = "column", 
    hcaes(x = year, y = emission, group = activity)
  ) |>
  hc_yAxis(title = list(text = "Percentage CO<sub>2</sub>-eq emissions (%)")) |>
  hc_tooltip(valueDecimals = 0, valueSuffix = "%") |>
  hc_add_theme(a11y_theme) |>
  hc_colors(colors = as.vector(gradient(c("#FC9D88","#EF3106", "#501002"), 5)))

hc_plot

```

### Description

### Solutions

###

:::

## Industry {.smaller}

::: panel-tabset

### Map

```{r}
#| label: industry-emissions-map
#| echo: false
#| output-location: slide

plot_data <- maps_table(seeg_scope = "Processos Industriais")

hc_map <- maps_plot(min_color = "#F0BCD1", max_color = "#D23775")

hc_map

```

### Emissions

```{r}
#| label: industry-emissions
#| echo: false
#| output-location: slide

plot_data <- 
  emissions_table(
    seeg_activity = TRUE, 
    seeg_scope = "Processos Industriais", 
    type_list = "Emissão"
  )

hc_plot <- 
  emissions_plot(
    color_list = gradient(c("#F0BCD1","#D23775", "#430F24"), 6)
  )

hc_plot

```

### Fraction

```{r}
#| label: industry-fraction
#| echo: false
#| output-location: slide

plot_data <- seeg |>
  dplyr::filter(
    type %in% c("Emissão"),
    as.numeric(year) >= 1990,
    scope == "Processos Industriais"
  ) |>
  dplyr::group_by(activity, year) |>
  dplyr::summarise(emission = sum(emission, na.rm = TRUE), .groups = "drop") |>
  dplyr::mutate(emission = emission * 1e-6) |>
  group_by(year) |>
  mutate(emission = emission / sum(emission) * 100)

hc_plot <- 
  hchart(
    object = plot_data, 
    type = "column", 
    hcaes(x = year, y = emission, group = activity)
  ) |>
  hc_yAxis(
    title = list(
      text = "Percentage CO<sub>2</sub>-eq emissions (%)"
    )
  ) |>
  hc_tooltip(valueDecimals = 0, valueSuffix = "%") |>
  hc_add_theme(a11y_theme) |>
  hc_colors(colors = as.vector(gradient(c("#F0BCD1","#D23775", "#430F24"), 6)))

hc_plot

```

### Description

### Solutions

:::

## Energy {.smaller}

::: panel-tabset

### Map

```{r}
#| label: energy-emissions-map
#| echo: false
#| output-location: slide

plot_data <- maps_table(seeg_scope = "Energia")

hc_map <- maps_plot(min_color = "#B0BCD4", max_color = "#242E42")

hc_map

```

### Emissions

```{r}
#| label: energy-emissions
#| echo: false
#| output-location: slide

plot_data <- 
  emissions_table(
    seeg_activity = TRUE, 
    seeg_scope = "Energia", 
    type_list = "Emissão"
  ) %>%
  filter(!activity %in% c("Não Identificado", "Público", "Comercial"))

hc_plot <- 
  emissions_plot(
    color_list = gradient(c("#B0BCD4","#6179A8", "#242E42"), 6)
  )

hc_plot

```

### Fraction

```{r}
#| label: energy-fraction
#| echo: false
#| output-location: slide

plot_data <- seeg |>
  dplyr::filter(
    type %in% c("Emissão"),
    as.numeric(year) >= 1990,
    scope == "Energia",
    !activity %in% c("Não Identificado", "Público", "Comercial")
  ) |>
  dplyr::group_by(activity, year) |>
  dplyr::summarise(emission = sum(emission, na.rm = TRUE), .groups = "drop") |>
  dplyr::mutate(emission = emission * 1e-6) |>
  group_by(year) |>
  mutate(emission = emission / sum(emission) * 100)

hc_plot <- 
  hchart(
    object = plot_data, 
    type = "column", 
    hcaes(x = year, y = emission, group = activity)
  ) |>
  hc_yAxis(
    title = list(
      text = "Percentage CO<sub>2</sub>-eq emissions (%)"
    )
  ) |>
  hc_tooltip(valueDecimals = 0, valueSuffix = "%") |>
  hc_add_theme(a11y_theme) |>
  hc_colors(colors = as.vector(gradient(c("#B0BCD4","#6179A8", "#242E42"), 6)))

hc_plot

```

### Description

### Solutions

:::

## Agriculture {.smaller}

::: panel-tabset

### Map

```{r}
#| label: agriculture-emissions-map
#| echo: false
#| output-location: slide

plot_data <- maps_table(seeg_scope = "Agropecuária")

hc_map <- maps_plot(min_color = "#F9DCB3", max_color = "#432905")

hc_map

```

### Emissions

```{r}
#| label: agriculture-emissions
#| echo: false
#| output-location: slide

plot_data <- 
  emissions_table(
    seeg_activity = TRUE,
    seeg_scope = "Agropecuária", 
    type_list = "Emissão"
  )
  
hc_plot <- 
  emissions_plot(
    color_list = gradient(c("#F9DCB3","#EE961B", "#432905"), 6)
  )

hc_plot

```

### Fraction

```{r}
#| label: agriculture-fraction
#| echo: false
#| output-location: slide

plot_data <- seeg |>
  dplyr::filter(
    type %in% c("Emissão", "Remoção"),
    as.numeric(year) >= 1990,
    scope == "Agropecuária",
  ) |>
  dplyr::group_by(activity, year, type) |>
  dplyr::summarise(emission = sum(emission, na.rm = TRUE), .groups = "drop") |>
  dplyr::mutate(emission = emission * 1e-6) |>
  group_by(year) |>
  mutate(emission = emission / sum(emission) * 100)

hc_plot <- 
  hchart(
    object = plot_data, 
    type = "column", 
    hcaes(x = year, y = emission, group = activity)
  ) |>
  hc_yAxis(
    title = list(
      text = "Percentage CO<sub>2</sub>-eq emissions (%)"
    )
  ) |>
  hc_tooltip(valueDecimals = 0, valueSuffix = "%") |>
  hc_add_theme(a11y_theme) |>
  hc_colors(colors = as.vector(gradient(c("#F9DCB3","#EE961B", "#432905"), 6)))

hc_plot

```

### Emissions NCI

```{r}
#| label: agriculture-nci-emissions
#| echo: false
#| output-location: slide

plot_data <- seeg |>
  dplyr::filter(
    type %in% c("Emissão NCI", "Remoção NCI"),
    as.numeric(year) >= 1990,
    scope == "Agropecuária",
  ) |>
  dplyr::group_by(activity, year, type) |>
  dplyr::summarise(emission = sum(emission, na.rm = TRUE), .groups = "drop") |>
  dplyr::mutate(emission = emission * 1e-6)

hc_plot <- 
  hchart(
    object = plot_data, 
    type = "column", 
    hcaes(x = year, y = emission, group = activity)
  ) |>
  hc_yAxis(
    title = list( 
      text = "CO<sub>2</sub>-eq emissions (Mt)"
    )
  ) |>
  hc_tooltip(valueDecimals = 0, valueSuffix = "Mt") |>
  hc_add_theme(a11y_theme) |>
  hc_colors(colors = as.vector(gradient(c("#F9DCB3","#EE961B", "#432905"), 6)))

hc_plot

```

### Description

### Solutions

:::

## Land Use Change {.smaller}

::: panel-tabset

### Map

```{r}
#| label: luc-emissions-map
#| echo: false
#| output-location: slide

plot_data <- maps_table(seeg_scope = "Mudança de Uso da Terra e Floresta")

hc_map <- maps_plot(min_color = "#8BBB96", max_color = "#26402C")

hc_map

```

### Emissions

```{r}
#| label: luc-emissions
#| echo: false
#| output-location: slide

plot_data <- 
  emissions_table(
    seeg_activity = TRUE,
    seeg_scope = "Mudança de Uso da Terra e Floresta",
    type_list = c("Emissão", "Remoção")
  )

hc_plot <- 
  emissions_plot(
    color_list = gradient(c("#8BBB96","#5B9A69", "#26402C"), 5)
  )

hc_plot

```

### Fraction

```{r}
#| label: luc-fraction
#| echo: false
#| output-location: slide

plot_data <- seeg %>%
  filter(
    type %in% c("Emissão", "Remoção"),
    as.numeric(year) >= 1990,
    scope == "Mudança de Uso da Terra e Floresta"
  ) %>%
  group_by(activity, type, year) %>%
  summarise(emission = sum(emission, na.rm = TRUE), .groups = "drop") %>%
  mutate(
    emission = emission * 1e-6
  ) |>
  group_by(year, type) |>
  mutate(emission = emission / sum(emission) * 100) |>
  mutate(emission = if_else(type == "Remoção", emission * -1, emission))

hc_plot <- 
  hchart(
    object = plot_data, 
    type = "column", 
    hcaes(x = year, y = emission, group = activity)
  ) |>
  hc_yAxis(
    min = -100, 
    endOnTick = FALSE, 
    title = list(
      text = "Percentage CO<sub>2</sub>-eq emissions (%)"
    )
  ) |>
  hc_tooltip(valueSuffix = "%") |>
  hc_add_theme(a11y_theme) |>
  hc_colors(colors = as.vector(gradient(c("#8BBB96","#5B9A69", "#26402C"), 5)))

hc_plot

```

### Description

### Solutions

:::
